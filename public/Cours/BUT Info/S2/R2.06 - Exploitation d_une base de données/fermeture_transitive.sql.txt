-- la fermeture transitive de la relation de subordination
with recursive fermeture as (
  select sub, sup, 1 as niveau
  from dirige d
  UNION
  select d.sub, f.sup, niveau + 1
  from fermeture f inner join dirige d
  on f.sub = d.sup) 
select *
from fermeture;
